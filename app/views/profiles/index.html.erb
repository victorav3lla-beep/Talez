<!-- app/views/profiles/index.html.erb -->

<!-- 1. J'ouvre le background au tout début pour qu'il contienne tout -->
<div class="profile-background">

  <!-- Gooey blob effect -->
  <%= render 'gooey_background' %>

  <!-- 2. Votre contenu Logo -->
  <div class="profile-logo" data-controller="logo-switcher">
    <%= link_to root_path, class: "profile-logo-link" do %>
      <%= image_tag 'logo_talez_1.png', alt: 'TALEZ', class: 'profile-logo-image', data: { logo_switcher_target: 'logo1' } %>
      <%= image_tag 'logo_talez_2.png', alt: 'TALEZ', class: 'profile-logo-image', style: 'display: none;', data: { logo_switcher_target: 'logo2' } %>
    <% end %>
  </div>

  <!-- 3. Votre sélecteur de profils -->
  <div id="profile-selector">
    <% @profiles.each do |profile| %>
      <div class="profile-container">
        <%= button_to select_profile_path(profile), method: :post, class: "profile-btn" do %>
          <% if profile.image.attached? %>
            <%= cl_image_tag profile.image.key, height: 300, width: 400, crop: :fill, class: "avatar-xl" %>
          <% else %>
            <%= image_tag("https://res.cloudinary.com/dyzpce9wi/image/upload/v1765286699/Netflix-avatar_z4ahkh.png", width: 150, height: 150, class: "avatar-xl") %>
          <% end %>
          <p><%= profile.username %></p>
        <% end %>
        <%= link_to raw("&times;"), profile_path(profile), 
            data: { turbo_method: :delete, turbo_confirm: "Are you sure you want to delete #{profile.username}?" }, 
            class: "profile-delete-btn",
            title: "Delete Profile" %>
      </div>
    <% end %>

    <%= link_to new_user_profile_path(current_user), class: "add-profile-container" do %>
      <%= image_tag("https://res.cloudinary.com/dyzpce9wi/image/upload/v1765286698/new_profile_boxuau.png", width: 150, height: 150, class: "avatar-xl") %>
      <p>Add profile</p>
    <% end %>
  </div>

<!-- 4. Je ferme le background tout à la fin -->
</div>
