<div class="stories-library-container">
  <!-- Sidebar -->
  <%= render 'shared/sidebar', active: 'stories' %>

  <!-- Main Content -->
  <div class="main-content">
    <!-- Top Header -->
    <%= render 'shared/header', profile: current_profile %>

    <!-- Library Hero Section -->
    <section class="library-hero-section">
      <div class="library-hero-content">
        <h1 class="library-title">
          <i class="fas fa-book-open"></i>
          Story Library
        </h1>
        <p class="library-subtitle">Discover and like amazing stories from the community</p>
      </div>
    </section>

    <!-- Featured Stories Carousel -->
    <% if @featured_stories.any? %>
      <section class="featured-carousel-section">
        <h2 class="section-title">
          <i class="fas fa-fire"></i>
          Most Popular Stories
        </h2>
        <div class="stories-scroll-wrapper" data-controller="stories-carousel">
          <button class="scroll-arrow scroll-arrow-left" data-action="click->stories-carousel#scrollLeft">
            <i class="fas fa-chevron-left"></i>
          </button>

          <div class="stories-scroll-container">
            <% @featured_stories.each do |story| %>
              <%= render 'stories/featured_card', story: story, current_profile: current_profile %>
            <% end %>
          </div>

          <button class="scroll-arrow scroll-arrow-right" data-action="click->stories-carousel#scrollRight">
            <i class="fas fa-chevron-right"></i>
          </button>
        </div>
      </section>
    <% end %>

    <!-- Filter Tabs + Stories List -->
    <section class="stories-list-section">
      <!-- Filter Tabs -->
      <div class="filter-tabs">
        <%= link_to stories_path(filter: 'popular'), class: "filter-tab #{@current_filter == 'popular' ? 'active' : ''}" do %>
          <i class="fas fa-fire"></i>
          Popular
        <% end %>
        <%= link_to stories_path(filter: 'recent'), class: "filter-tab #{@current_filter == 'recent' ? 'active' : ''}" do %>
          <i class="fas fa-clock"></i>
          Recent
        <% end %>
        <%= link_to stories_path(filter: 'my_stories'), class: "filter-tab #{@current_filter == 'my_stories' ? 'active' : ''}" do %>
          <i class="fas fa-book"></i>
          My Stories
        <% end %>
        <%= link_to stories_path(filter: 'my_characters'), class: "filter-tab #{@current_filter == 'my_characters' ? 'active' : ''}" do %>
          <i class="fas fa-user-astronaut"></i>
          My Characters
        <% end %>
        <%= link_to stories_path(filter: 'my_universes'), class: "filter-tab #{@current_filter == 'my_universes' ? 'active' : ''}" do %>
          <i class="fas fa-globe"></i>
          My Universes
        <% end %>
      </div>

      <!-- Content based on filter -->
      <% if @current_filter == 'my_characters' %>
        <!-- Characters Grid -->
        <% if @characters.any? %>
          <div class="row g-4">
            <% @characters.each do |character| %>
              <%= render 'characters/card', character: character, show_actions: true %>
            <% end %>
          </div>
        <% else %>
          <div class="empty-state-simple">
            <div class="empty-icon">ğŸ¦¸</div>
            <h3>No characters found</h3>
            <p>You haven't created any characters yet.</p>
            <%= link_to new_character_path, class: 'btn-create' do %>
              <i class="fas fa-plus-circle"></i>
              Create Your First Character
            <% end %>
          </div>
        <% end %>
      <% elsif @current_filter == 'my_universes' %>
        <!-- Universes Grid -->
        <% if @universes.any? %>
          <div class="row g-4">
            <% @universes.each do |universe| %>
              <%= render 'universes/card', universe: universe, show_actions: true %>
            <% end %>
          </div>
        <% else %>
          <div class="empty-state-simple">
            <div class="empty-icon">ğŸŒ</div>
            <h3>No universes found</h3>
            <p>You haven't created any universes yet.</p>
            <%= link_to new_universe_path, class: 'btn-create' do %>
              <i class="fas fa-plus-circle"></i>
              Create Your First Universe
            <% end %>
          </div>
        <% end %>
      <% else %>
        <!-- Stories List -->
        <% if @stories.any? %>
          <div class="stories-list">
            <% @stories.each do |story| %>
              <%= render 'stories/row_card', story: story, current_profile: current_profile %>
            <% end %>
          </div>
        <% else %>
          <div class="empty-state-simple">
            <div class="empty-icon">ğŸ“š</div>
            <h3>No stories found</h3>
            <p>
              <% if @current_filter == 'my_stories' %>
                You haven't created any stories yet.
              <% else %>
                No stories available at the moment.
              <% end %>
            </p>
            <% if @current_filter == 'my_stories' %>
              <%= link_to characters_path, class: 'btn-create' do %>
                <i class="fas fa-plus-circle"></i>
                Create Your First Story
              <% end %>
            <% end %>
          </div>
        <% end %>
      <% end %>
    </section>
  </div>
</div>
